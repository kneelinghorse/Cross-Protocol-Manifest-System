# v0.4.0 – Scope Migration & CLI Hardening

All eight core protocol packages are now published to npm under the `@cpms` scope (`core`, `data`, `event`, `api`, `agent`, `semantic`, `catalog` at `0.4.0`) with the CLI patching forward to `@cpms/cli@0.4.1`. Docs, changelog entries, and the in-repo examples have been updated accordingly so that install commands and quick-start snippets point to the live scope.

## Highlights
- **Cross-scope publish:** npm publishes complete successfully under `@cpms`, and the CLI now falls back to local protocol implementations if the packages are unavailable.
- **Protocol stability:** Data protocol hashing/clone paths were rewritten for deterministic schema hashes, semantic protocol bindings gained a new query parser, and catalog integration now exercises the HTTP resolver end-to-end.
- **CLI validation routing:** `proto validate` inspects the manifest type and fans out to the correct protocol factory automatically, which means mixed manifests in the same workspace are handled without flags.
- **API perf harness:** Tests now include a short warm-up period and proper percentile math so the manifest parsing/diff benchmarks hold steady on CI hardware (≤50 ms / ≤40 ms p99 respectively).
- **Docs sweep:** README tables, publishing guide, and community changelog now list the `@cpms/*` packages so GitHub release notes and npm descriptions stay aligned.

## npm Packages
| Package | Version | Notes |
|---------|---------|-------|
| `@cpms/core` | 0.4.0 | Foundation utilities (hashing, canonical JSON, validator registry). |
| `@cpms/data` | 0.4.0 | Data protocol v1.1.1 with migration synthesis and deterministic hashing. |
| `@cpms/event` | 0.4.0 | AsyncAPI/Kafka compatible event protocol. |
| `@cpms/api` | 0.4.0 | OpenAPI 3.0.3 generation + client SDK emitter. |
| `@cpms/agent` | 0.4.0 | Agent manifests, delegation graphs, diff tooling. |
| `@cpms/semantic` | 0.4.0 | Semantic protocol v3.2.0 with intent/criticality scoring. |
| `@cpms/catalog` | 0.4.0 | URN catalog + HTTP resolver integration. |
| `@cpms/cli` | 0.4.1 | `proto` CLI (validate/diff/query/graph) with registry fallback. |

Install or upgrade the CLI:

```bash
pnpm add -g @cpms/cli
# or
npm install -g @cpms/cli
```

## Testing & Validation
- `pnpm test`
- `node --test api-protocol.test.js`
- `python3 cmos/scripts/validate_parity.py`

## Known Issues
- CMOS parity helpers now run standalone, but `cmos/scripts/validate_parity.py` still reads/writes mirrors in place. Take backups if you plan to consume the JSON/YAML outputs downstream.

## Next Steps
- Tag `v0.4.0` and draft the GitHub release using these notes.
- Kick off the documentation deployment (mission B4.9) once the release is published.
